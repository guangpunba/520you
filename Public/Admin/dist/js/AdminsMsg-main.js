require(["layer","common","loadueditor"],function(t){t.config({path:jsUrl+"/libs/layer/"}),$("#submitAdd").removeClass("am-disabled").on("click",function(e){e.preventDefault();var i=$(this),n=$("#form").serializeArray(),o=$("#pushobj").val();i.button("loading"),$.when($.ajax({url:_APP+"/AdminsMsg/addMsg",method:"POST",data:n})).then(function(t){var e=t.info;if(0!=t.status)return $.ajax({url:_APP+"/AdminsMsg/pushMsg",method:"POST",data:{pushobj:o}});var n=e.field,s=e.tipsinfo;$(".form_tips").remove(),$("#"+n).focus(),$("#"+n).after("<div class='form_tips am-text-sm am-text-danger'>"+s+"</div>"),setTimeout(function(){i.button("reset")},1e3)},function(){t.msg("添加消息失败")}).then(function(e){e.indexOf("ok")>0&&($(".form_tips").remove(),t.msg("推送消息成功",{icon:1,time:2e3},function(){location.href=_APP+"/AdminsMsg/index"}))},function(){t.msg("推送消息失败")})})});