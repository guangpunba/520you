define(["jquery","layer"],function(t,e){var i=function(t,i,n){$.ajax({url:t,method:"POST",data:i,success:function(t){var i=t.info;if(0==t.status){var o=i.field,s=i.tipsinfo;$(".form_tips").remove(),$("#"+o).focus(),$("#"+o).after("<div class='form_tips am-text-sm am-text-danger'>"+s+"</div>"),setTimeout(function(){n.button("reset")},1e3)}else $(".form_tips").remove(),e.msg(i,{icon:1,time:2e3},function(){})}})},n=function(){$("#submitAdd").removeClass("am-disabled").on("click",function(t){t.preventDefault();var i=$(this),n=$("#form").serialize();i.button("loading"),$.when($.ajax({url:_APP+"/News/addNew",method:"POST",data:n})).then(function(t){var n=t.info;if(0==t.status){var o=n.field,s=n.tipsinfo;$(".form_tips").remove(),$("#"+o).focus(),$("#"+o).after("<div class='form_tips am-text-sm am-text-danger'>"+s+"</div>"),setTimeout(function(){i.button("reset")},1e3)}else $(".form_tips").remove(),e.msg(n,{icon:1,time:2e3},function(){return $.ajax({url:_APP+"/News/pushMsg",method:"POST"})})}).then(function(t){setTimeout(function(){console.log(t)},5e3)},function(){console.log("第二个请求错误")})})},o=function(){$("#submitEdit").removeClass("am-disabled").on("click",function(t){t.preventDefault();var e=$(this),n=$("#form").serializeArray(),o=$("#getid").val();e.button("loading"),n.push({name:"id",value:o}),i(_APP+"/News/editNews",n,e)})},s=function(){$(document).on("click",".delbtn",function(){var t=$(this).parents("tr").attr("data-id");e.confirm("确定要删除这条新闻吗？",{title:!1,btn:["确定","取消"]},function(){$.post(_APP+"/News/delNew",{id:t},function(t){1==t.status?e.msg(t.info,{icon:1,time:2e3},function(){location.href=location.href}):e.msg(t.info,{icon:2,time:2e3},function(){location.href=location.href})})},function(){e.closeAll()})})};s(),o(),n()});